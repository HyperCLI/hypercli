# Netlify Configuration for HyperCLI Monorepo
# Build commands are managed separately in Netlify UI

# Next.js Plugin for optimal performance and Edge Functions support
[[plugins]]
  package = "@netlify/plugin-nextjs"

[build.environment]
  NODE_VERSION = "22"
  
  # Cache version - increment this to force cache invalidation
  NEXT_PUBLIC_CACHE_VERSION = "4"

  # Disable debug in production
  NEXT_PUBLIC_AUTH_DEBUG = "false"

  # Cookie domain for cross-subdomain authentication
  NEXT_PUBLIC_COOKIE_DOMAIN = ".hypercli.com"
  NEXT_PUBLIC_COOKIE_VALIDITY = "15"

  # Site URLs
  NEXT_PUBLIC_MAIN_SITE_URL = "https://hypercli.com"
  NEXT_PUBLIC_CONSOLE_URL = "https://console.hypercli.com"
  NEXT_PUBLIC_CHAT_URL = "https://chat.hypercli.com"

  # Domain for GPU instance subdomains
  NEXT_PUBLIC_DOMAIN = "hypercli.com"

  # Instances API - always use production for full instance catalog
  NEXT_PUBLIC_INSTANCES_API_URL = "https://api.hypercli.com/instances"

  # WebSocket URL for job logs
  NEXT_PUBLIC_WS_URL = "wss://api.hypercli.com/orchestra/ws"

  # LLM API URL for chat completions
  NEXT_PUBLIC_LLM_API_URL = "https://api.hypercli.com/v1"

  # Bot API URL for thread-based chat
  NEXT_PUBLIC_BOT_API_URL = "https://api.hypercli.com/agent/api"

  # Default model for chat
  NEXT_PUBLIC_DEFAULT_MODEL = "minimax-m2"

  # Auth/API Backend
  NEXT_PUBLIC_AUTH_BACKEND = "https://api.hypercli.com/api"
  NEXT_PUBLIC_API_BASE = "https://api.hypercli.com/api"

  # Turnkey Configuration
  NEXT_PUBLIC_ORGANIZATION_ID = "20691c9c-a40b-44cb-8ace-aac3965f25c0"
  NEXT_PUBLIC_AUTH_PROXY_CONFIG_ID = "fb58b5e9-0e45-4954-9672-dadd7a7f166a"
  NEXT_PUBLIC_BASE_URL = "https://api.turnkey.com"
  NEXT_PUBLIC_AUTH_PROXY_URL = "https://authproxy.turnkey.com"

  # Google OAuth
  NEXT_PUBLIC_GOOGLE_OAUTH_CLIENT_ID = "966038109624-uj8vveij878m0uohnq99g8b29jcqi2a0.apps.googleusercontent.com"

  # WalletConnect (for RainbowKit)
  # NEXT_PUBLIC_WALLETCONNECT_PROJECT_ID = "your-walletconnect-project-id"

  # Payment Configuration - LIVE
  NEXT_PUBLIC_STRIPE_PK_CLI = "pk_live_51SSWmjQcZcim9HgToGFTGl2i2ujksoZxVxl6Hnsy9Py2cxo9IWZY0852aiFcKEe2rrcozuYkf1UUhDKJuoyRCeS600gouzMj9F"

  # HyperClaw
  NEXT_PUBLIC_STRIPE_PK_CLAW = "pk_live_51Swl9SRZTaGJgE4BPe4ljplqQJQY8KoXjDZc2uOsiyublXnL5VDO4jA9VRTGDHUbAOXz0ZkbWqKMpEYPWvMvl2SS00XIDqCm4A"
  NEXT_PUBLIC_CLAW_URL = "https://hyperclaw.app"
  NEXT_PUBLIC_PRIVY_APP_ID = "cml5njpn701s2ky0cjd0y1vzq"
  NEXT_PUBLIC_CLAW_API_URL = "https://api.hyperclaw.app"

# Non-production (branch deploys)
[context.branch-deploy.environment]
  NEXT_PUBLIC_STRIPE_PK_CLI = "pk_test_51So7MuD2ZZvODGmahxL1H1uM1GS1zEllTp6UCjKlB7Ga6Wqv6YyoY7WgIUDOAoGQutVAEeTexlkmWAhhW5wMdgtP00bN74gl6d"
  NEXT_PUBLIC_STRIPE_PK_CLAW = "pk_test_51Swl9SRZTaGJgE4B3Fc9kjdJ7hEz06ikaE9aKNiJIEkgt4c4ONQZMMRjuWz5DtsUpUw70v3FiN8AhhXINO41wf3Z00YNmVwtyy"
  NEXT_PUBLIC_PRIVY_APP_ID = "cml5no19f001jla0dc105snyy"
  NEXT_PUBLIC_CLAW_API_URL = "https://dev-api.hyperclaw.app"

# Non-production (deploy previews)
[context.deploy-preview.environment]
  NEXT_PUBLIC_STRIPE_PK_CLI = "pk_test_51So7MuD2ZZvODGmahxL1H1uM1GS1zEllTp6UCjKlB7Ga6Wqv6YyoY7WgIUDOAoGQutVAEeTexlkmWAhhW5wMdgtP00bN74gl6d"
  NEXT_PUBLIC_STRIPE_PK_CLAW = "pk_test_51Swl9SRZTaGJgE4B3Fc9kjdJ7hEz06ikaE9aKNiJIEkgt4c4ONQZMMRjuWz5DtsUpUw70v3FiN8AhhXINO41wf3Z00YNmVwtyy"
  NEXT_PUBLIC_PRIVY_APP_ID = "cml5no19f001jla0dc105snyy"
  NEXT_PUBLIC_CLAW_API_URL = "https://dev-api.hyperclaw.app"

# Cache control headers for static assets
[[headers]]
  for = "/*"
  [headers.values]
    # Don't cache HTML files to ensure latest content
    Cache-Control = "public, max-age=0, must-revalidate"

[[headers]]
  for = "/_next/static/*"
  [headers.values]
    # Next.js static assets have content hashes, can be cached forever
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "/static/*"
  [headers.values]
    # Static assets can be cached for a year
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "/*.js"
  [headers.values]
    # JavaScript files cached for 1 hour
    Cache-Control = "public, max-age=3600, must-revalidate"

[[headers]]
  for = "/*.css"
  [headers.values]
    # CSS files cached for 1 hour
    Cache-Control = "public, max-age=3600, must-revalidate"
