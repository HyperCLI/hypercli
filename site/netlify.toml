# Netlify Configuration for HyperCLI Monorepo
#
# Environment is managed via env files, NOT here.
# Each Netlify site sets its build command to load the right env:
#   Prod:  cp env.prod .env.local && npm run build
#   Dev:   cp env.dev .env.local && npm run build
#
# See env.prod, env.dev, env.sample for available variables.

# Next.js Plugin for optimal performance and Edge Functions support
[[plugins]]
  package = "@netlify/plugin-nextjs"

[build.environment]
  NODE_VERSION = "22"
  NODE_OPTIONS = "--max-old-space-size=4096"

# Cache control headers for static assets
[[headers]]
  for = "/*"
  [headers.values]
    # Don't cache HTML files to ensure latest content
    Cache-Control = "public, max-age=0, must-revalidate"

[[headers]]
  for = "/_next/static/*"
  [headers.values]
    # Next.js static assets have content hashes, can be cached forever
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "/static/*"
  [headers.values]
    # Static assets can be cached for a year
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "/*.js"
  [headers.values]
    # JavaScript files cached for 1 hour
    Cache-Control = "public, max-age=3600, must-revalidate"

[[headers]]
  for = "/*.css"
  [headers.values]
    # CSS files cached for 1 hour
    Cache-Control = "public, max-age=3600, must-revalidate"
